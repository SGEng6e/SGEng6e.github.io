---
title: "Establishment Reviews"
format: 
  html:
    grid:
      body-width: 6400px
    resources: 
      - shinylive-sw.js
filters:
  - shinylive
---
```{shinylive-r}
#| standalone: true
#| viewerHeight: 1000

library(shiny) # 1.8.0
library(tidyverse) # 2.0.0
library(leaflet) # 2.2.1
library(DT) # 0.31
library(terra) # 1.7-65

{reviews <- 
  data.frame(Name = c("Kuidaore","Yangtze Restaurant","Lola's Kitchen","Koichi Ramen","Phở Bắc Oriental Cuisine",
                    "Haldi","Sushi-ro","Suya Palace Charcoal Grill & BBQ","Eldorado Taco","Vivaan (Katha Ottawa)",
                    "K LET'S EAT","New Mee Fung Restaurant","Osmow's Shawarma","Last Train to Delhi",
                    "J:unique kitchen","Blue Nile Ethiopian","Vietnamese Kitchen","Viêt-Thai","Ceylonta",
                    "Tamis Cafe & Restaurant","Saigon Phở","Rangoon Restaurant","Chili Chili Restaurant",
                    "Phuket Royal","YKO Chicken BBQ","Gyubee Japanese Grill (Ottawa)",
                    "Thali","Afghani Kabob Express","Hareg Cafe & Variety","Sushi 88",
                    "La Fiesta Latina","Anthony's Pizza","Siam Bistro","MHK Sushi",
                    "GoGiYa Sushi n Poké","Talay Thai","Shawarma Palace","Social Thai",
                    "Daldongnae Korean BBQ - Ottawa Somerset","Feleena's","Pho Tuan",
                    "PHO 99","Wolf Down","JOEY Lansdowne","Korean House Restaurant",
                    "Pho Bo Ga 2 Snack Bar","Fil's Diner","The Hintonburg Public House",
                    "TacoLot","La Paladar","Falafel Scoop","Score Pizza","Margarita",
                    "Lemongrass Thai Cuisine","Tealive Somerset Chinatown","Drip House (Mechanicsville)",
                    "Ceasar Rosa's U-Rock Cafe","Carmelito Cafe","Oat Couture Oatmeal Cafe (Gladstone)",
                    "The Ministry of Coffee and Social Affairs","Art House","Little Victories Coffee Roasters - Glebe",
                    "Seven Tea Miles","Arlington Five","Little Victories Coffee",
                    "Art-Is-In Bakery","Grounded Kitchen & Coffee Bar","5:2:8 Creative Coffee Collective",
                    "Izakaya Shingen (Burrito Sensei)","Pour Boy - Somerset","Beyond the Pale Brewing Company",
                    "Pub Italia","Braumeister Bierhalle & Bistro Polo","Tooth and Nail Brewing Company",
                    "Atomic Rooster","Torta Boyz","The Royal Oak - Bank at Gloucester",
                    "VIP KARAOKE BAR INC","Spark Beer","Saigon Restaurant","Sir John A Pub",
                    "The Lieutenant's Pump","Trio Bistro and Lounge","Newboro",
                    "Fauna","Flora Hall Brewing","Clocktower Brew Pub Glebe","WARD 14",
                    "The Moonroom","The Porch","The Wood On Wellington","Vain in Versailles Bistro",
                    "The Merry Dairy","Moo Shu Ice Cream & Kitchen","Haven's Creamery",
                    "Elgin Street Diner","ThimbleCakes","Raphaël Peruvian Cuisine",
                    "Taj Indian Cuisine","GRAB N' EAT GROCERS","Drip House (Chinatown)",
                    "Drip House (Hintonburg)","Mike's Place","Rooster's Coffeehouse",
                    "Ollie's Pub & Patio","Dairy Queen Grill & Chill","Mystiko",
                    "Bier Markt","But First -- Coffee (BFC) - Boni","Unnamed billiards shelter",
                    "Tag-ayaran Valley Bar & Restaurant","Straight Up Bar Seda Residences Makati",
                    "Ippudo SM Megamall","Manam Greenbelt","Cold Stone Creamery",
                    "ESPRESSO'D","Potato Corner","Ramen Nagi","Key Coffee Kissaten",
                    "The Peak Grill","Kiwami Food Hall","Wolfgang's Steakhouse by Wolfgang Zwiener",
                    "Elephant Grounds Manila - BGC","Nono's","The Lounge","Manam Comfort Filipino",
                    "Tim Hortons","La Mesa","Romantic Beach Villas","Derecho",
                    "BARREL: Beachfront Sports Bar","Sibol Siargao","The Grid",
                    "Twelve Ten","The Coffee Bean & Tea Leaf","Second Cup Cafe",
                    "Aztec tacos","Kochu","Persis Grill","Longshots Sports Bar & Grill",
                    "Brewer's Kitchen & Taproom","Liquid State Brewing Company",
                    "The Odys Boutique Hotel","Terraço Sky Bar","Quán Nhậu Tự Do",
                    "M.O.A","Hôtel des Arts Saigon - MGallery","Top of Hanoi",
                    "Gazette café","Triskell Montpellier","Tarbrew","Microbrasserie La Barbote",
                    "Thai to Box","Hôtel Du Palais","Wasabi Sushi","Nikosi Bistro Pub",
                    "Kinka Izakaya Carlton","Osmow's Shawarma","Fran's Restaurant and Bar",
                    "Pancho y Emiliano","Khao San Road","3 Brewers","401 Cider Brewery",
                    "Adamson Barbecue","Conspiracy Pizza","Ajiya Sushi","Al's Diner",
                    "Amsterdam Brewhouse","Athens Restaurant","Auberge Du Pommier",
                    "Bank Bar Taguig","Barcino Ortigas Pasig","Baruco By Cuzco Gastro",
                    "Bar Chef","Bawarchee","Bean Around The World","Bellevue Cafe",
                    "Cue's Game Room","Bello Ristorante","Blenz Coffee Penticton",
                    "Blenz Coffee","Ben Thanh Express","Biercraft Westbrook","Big Al's Bakery & Deli",
                    "Billy's Deli","Black Tap Midtown","Blended","Bloom","Bowman's on Bank",
                    "Bowman's","Boxcar Social","Breakfast Table","Bridges Restaurant",
                    "Brochetterie Chifa","Brookstreet F & B","Brulerie Du Quai",
                    "BOM Bar","Bukash","Chả Cá Thăng Long","C'est Japon A Suisha / Suisha Garden",
                    "Caffe Express","Casa Cubana","Casa Manila","Casa Mexico",
                    "Central Bierhaus","Douce Diner","Cluny Bistro & Boulangerie",
                    "Somerset View","Chez Piggy","Tay Ho","The Fossil & Haggis",
                    "The Orange Monkey","The Scots Corner","The Morrissey House",
                    "Tickleberry's","The Bytowne","Wilbur Mexicana","Cinema Le Cube",
                    "Modavie","Cafe Des Artistes","Oh Les Pains","Off The Tracks Espresso",
                    "N'awlins Jazz","Rex's Den","Ruby's Diner","Salad King","Congee Queen",
                    "Fox Theatre","Civil Liberties","Mayfair Theatre","Medici's Gelateria",
                    "London Ale House","Magic Sushi","Maha's Brunch","Maja Indian Cuisine",
                    "Lahore Tikka House","Lalibela","Le Cafe Entre Amis","Minari",
                    "Pai","Saka Izakaya","Pujukan Authentic Korean BBQ","Perfect Chinese Restaurant",
                    "Red Cranberries Restaurant","Sierpe Cocina Caribe","Sofra Istanbul",
                    "Sula Wok","Flo's Diner","Hakka Legend","Federick Restaurant",
                    "Daio","Green Grotto","Pubwell's","Radio Station Cafe","Quinn's Ale House",
                    "Resto De La Plage","Over Easy","Table Sodam","Tabule","K Mountain Diner",
                    "Kama Sutra","Kiko Sushi","Lamanna's Bakery","Koox Hana",
                    "La Jasette Comptoir","Lac Vien","Level One","Masson Marina",
                    "Pub St Joseph","Spring Sushi","Tanakaya Japanese","The Corner Bank",
                    "The George Street Diner","The Comfort Diner","The Boulevard Coffee Roasting",
                    "Thaifoon","Udupi Krishna","Vancouver Fish Company","Vindaloo Express",
                    "Yumei Sushi","Zakkushi","Casa Palenque","Yum Yum Pizza",
                    "Vegan Danish Bakery","The Pho Shack","The Alibi Room","Pattaya Kitchen",
                    "Ooma","Nikkei Robata","Holy Diver","Sultan Bbq & Grill",
                    "Yume","Hyderabad Biryani Hut","Iron Rooster Rotisseri","Jazz Bistro",
                    "Hokkaido Ramen Santouka","Jo Jos Cafe","Kintaro Izakaya Toronto",
                    "Juan Valdez","Hikari","Gorudoya","Guatila Restaurante","Kinka Izakaya Annex",
                    "New Generation Sushi","Coffee Culture","Fatboys Southern Smokehouse",
                    "Finnigan's Pub","Function Bar","Foolish Chicken","Zoe's",
                    "Aroma Meze","Gooney's","Host India","L'Oree Du Bois","Brasserie du Bas",
                    "Bandito's","Thr33'S Snack Bar","Ten Toes Coffee","Cantina Gia",
                    "Beandigen Cafe","Bar Lupulus","Pho Thu Do","The Rowan","Joey Landsdowne",
                    "Mona's Taqueria","Halibut House","Cindy's Restaurant","Dreamland Cafe",
                    "John's Diner","Second Cup Cafe","Ayla's Social Kitchen","The Secret Beach Bar & Kitchen",
                    "Verdi's","No.12 Jiangjiu","Proud Mary's","Taco Bell","Pump House",
                    "The Observatory","Langland's Brasserie","Mums Daily","Barker Coffee Cardiff",
                    "The Prince of Wales - JD Wetherspoon","Skirrid Mountain Inn",
                    "Regency 59","Y Bwyty","Lamb and Flag","The Bear Inn","The Grand Cafe",
                    "Colombia Coffee Roasters","Oxford Cheese Co","George and Danver",
                    "River Hotel","Dosa Park","The Green Room","Halloumi Glasgow",
                    "All Bar One Glasgow","Cafe Fame","The Hidden Lane Tea Room",
                    "Number 27 Bar and Kitchen","Albanach","Nok's Kitchen","Copper Still","Biblos"),
           Style = c("Japanese","Chinese","Filipino","Japanese","Vietnamese","Indian","Japanese","Nigerian",
                     "Mexican","Indian","Korean","Vietnamese","Egyptian","Indian","Japanese","Ethiopian",
                     "Vietnamese","Vietnamese","Sri-Lankan","Filipino","Vietnamese","Burmese","Chinese",
                     "Thai","Ivorian","Japanese","Indian","Afghani","Ethiopian","Japanese","Mexican","Italian",
                     "Thai","Japanese","Japanese","Thai","Lebanese","Thai","Korean","Mexican","Vietnamese",
                     "Vietnamese","German","Fusion","Korean","Vietnamese","Diner","Fusion","Mexican","Mexican",
                     "Syrian","Canadian","Mexican","Thai","Cafe","Cafe","Cafe","Cafe","Cafe","Cafe","Cafe",
                     "Cafe","Cafe","Cafe","Cafe","Cafe","Cafe","Cafe","Japanese","Bar","Brewery","Bar","Bar",
                     "Bar","Bar","Mexican","Bar","Korean","Fusion","Vietnamese","Bar","Bar","Lounge","Bar",
                     "Fusion","Brewery","Bar","Lounge","Lounge","Bar","Bar","Lounge","Dessert","Dessert","Dessert",
                     "Diner","Dessert","Peruvian","Indian","Filipino","Cafe","Cafe","Bar","Coffee","Bar","Dessert",
                     "Greek","Bar","Cafe","Recreation","Filipino","Lounge","Japanese","Filipino","Dessert",
                     "Cafe","Fast food","Japanese","Lounge","Lounge","Japanese","Steakhouse","Fusion",
                     "Filipino","Lounge","Filipino","Cafe","Fusion","Fusion","Filipino","Fusion","Lounge","Fusion",
                     "Japanese","Cafe","Cafe","Mexican","Japanese","Persian","Bar","Brewery","Brewery","Vietnamese",
                     "Lounge","Vietnamese","Vietnamese","Lounge","Lounge","French","Bar","Brewery","Brewery","Thai",
                     "French","Japanese","Canadian","Japanese","Egyptian","Diner","Mexican","Thai","Brewery","Brewery",
                     "Southern","Canadian","Japanese","Diner","Brewery","Greek","French","Lounge","Spanish",
                     "Colombian","Lounge","Pakistani","Cafe","Cafe","Bar","Italian","Cafe","Cafe","Vietnamese",
                     "Bar","Cafe","Diner","Diner","Cafe","Fusion","Bar","Bar","Cafe","Diner","Seafood","Peruvian",
                     "Music Lounge","Cafe","Lounge","Cafe","Vietnamese","Japanese","Cafe","Cuban","Filipino","Mexican",
                     "German","Diner","French","Vietnamese","Fusion","Vietnamese","Bar","Bar","Bar","Bar","Dessert",
                     "Recreation","Mexican","Recreation","Fusion","Cafe","Cafe","Cafe","Music Lounge","Bar","Diner",
                     "Thai","Chinese","Recreation","Lounge","Recreation","Dessert","Bar","Japanese","Egyptian",
                     "Indian","Pakistani","Ethiopian","Canadian","Korean","Thai","Japanese","Korean","Chinese",
                     "Fusion","Carribean","Turkish","Fusion","Diner","Hakka","Hakka","Japanese","Taiwanese","Bar",
                     "Cafe","Bar","Seafood","Diner","Korean","Lebanese","Diner","Indian","Japanese","Cafe","Mexican",
                     "Cafe","Vietnamese","Bar","Bar","Canadian","Japanese","Japanese","Bar","Diner","Diner","Cafe",
                     "Thai","Indian","Seafood","Indian","Japanese","Japanese","Bar","Fusion","Cafe","Vietnamese","Brewery",
                     "Thai","Japanese","Japanese","Bar","Pakistani","Japanese","Pakistani","Canadian","Music Lounge",
                     "Japanese","Cafe","Japanese","Cafe","Japanese","Japanese","Colombian","Japanese","Japanese","Cafe",
                     "Southern","Bar","Lounge","Southern","Lounge","Greek","Venezuelan","Indian","French","Brewery",
                     "Mexican","Lounge","Cafe","Italian","Cafe","Canadian","Vietnamese","Canadian","Fusion","Mexican",
                     "Seafood","Diner","Italian","Diner","Cafe","Greek","English","Italian","Chinese","Bar","Fast food",
                     "Brewery","Fusion","English","Indian","Cafe","Bar","Bar","Indian","English","English","English",
                     "English","Cafe","Deli","Dessert","English","Indian","English","Greek","Lounge","Cafe","English",
                     "Scottish","Scottish","Thai","Scottish","Scottish"),
           Continent = c("Asian","Asian","Asian",
                         "Asian","Asian","South Asian","Asian","African","Central/South American",
                         "South Asian","Asian","Asian","Middle Eastern","South Asian",
                         "Asian","African","Asian","Asian","South Asian","Asian",
                         "Asian","Asian","Asian","Asian","African","Asian","South Asian",
                         "Middle Eastern","African","Asian","Central/South American",
                         "European","Asian","Asian","Asian","Asian","Middle Eastern",
                         "Asian","Asian","Central/South American","Asian","Asian",
                         "European","North American","Asian","Asian","North American",
                         "North American","Central/South American","Central/South American",
                         "Middle Eastern","North American","Central/South American",
                         "Asian","Asian","North American","North American","European",
                         "North American","North American","North American","North American",
                         "South Asian","North American","North American","North American",
                         "North American","North American","Asian","North American",
                         "North American","European","European","North American","North American",
                         "Central/South American","European","Asian","North American",
                         "Asian","North American","North American","North American",
                         "North American","North American","North American","North American",
                         "North American","North American","North American","North American",
                         "North American","North American","Asian","North American",
                         "North American","North American","Central/South American",
                         "South Asian","Asian","North American","North American","North American",
                         "North American","North American","North American","European",
                         "North American","North American","Asian","Asian","North American",
                         "Asian","Asian","North American","North American","North American",
                         "Asian","Asian","North American","Asian","North American",
                         "Asian","Asian","North American","Asian","North American",
                         "Asian","Asian","Asian","North American","Asian","Asian",
                         "Asian","North American","North American","Central/South American",
                         "Asian","Middle Eastern","North American","North American",
                         "North American","Asian","Asian","Asian","Asian","Asian",
                         "Asian","European","European","European","European","Asian",
                         "European","Asian","North American","Asian","Middle Eastern",
                         "North American","Central/South American","Asian","North American",
                         "North American","North American","North American","Asian",
                         "North American","North American","European","European","North American",
                         "European","Central/South American","North American","South Asian",
                         "North American","North American","North American","European",
                         "North American","North American","Asian","North American",
                         "North American","North American","North American","North American",
                         "Central/South American","North American","North American",
                         "North American","North American","North American","Central/South American",
                         "North American","North American","Asian","Central/South American",
                         "Asian","Asian","Asian","Central/South American","Asian",
                         "Central/South American","European","North American","European",
                         "Asian","European","Asian","European","North American","European",
                         "North American","North American","North American","Central/South American",
                         "North American","North American","North American","North American",
                         "North American","North American","North American","North American",
                         "Asian","Asian","North American","North American","North American",
                         "European","North American","Asian","Middle Eastern","South Asian",
                         "South Asian","African","North American","Asian","Asian",
                         "Asian","Asian","Asian","North American","Central/South American",
                         "Middle Eastern","Asian","North American","South Asian","South Asian",
                         "Asian","Asian","North American","North American","European",
                         "North American","North American","Asian","Middle Eastern",
                         "North American","South Asian","Asian","European","Central/South American",
                         "European","Asian","North American","North American","North American",
                         "Asian","Asian","North American","North American","North American",
                         "North American","Asian","South Asian","North American","South Asian",
                         "Asian","Asian","Central/South American","North American",
                         "European","Asian","North American","Asian","Asian","Asian",
                         "North American","South Asian","Asian","South Asian","North American",
                         "North American","Asian","North American","Asian","Central/South American",
                         "Asian","Asian","Central/South American","Asian","Asian",
                         "North American","North American","European","North American",
                         "North American","North American","European","Central/South American",
                         "South Asian","European","North American","Central/South American",
                         "North American","North American","European","North American",
                         "North American","Asian","North American","North American",
                         "Central/South American","North American","North American",
                         "European","North American","North American","European","European",
                         "European","Asian","European","North American","European",
                         "European","European","South Asian","European","European",
                         "European","South Asian","European","European","European",
                         "European","European","European","European","European","South Asian",
                         "European","European","European","European","European","European",
                         "European","Asian","European","European"),
           Score = c(8.1,7.6,6.5,7.5,6.3,6.8,6.6,4.3,6.8,7.4,7.6,6.3,6.3,5.6,7.2,5,6.5,6.4,6,6.3,6.8,6.5,
                     7.3,6,6,6.3,6.6,6.3,7.2,7.3,8.2,7,6.8,5.3,7,7.2,6.2,5.8,NA,7.5,7.6,7.9,5.8,6.5,6,5.5,
                     5.5,6.5,5,7.5,5,4.5,5.3,6.3,7.1,5.8,7.4,6.2,7.6,6.5,7.9,6,7.5,5,6,5.3,6.8,5.8,8,6.1,
                     6.6,5.9,7.4,6.8,4.4,7.5,6.3,6.5,5.1,7.1,6.9,7,7.4,6.3,7.4,6.4,6,5.3,6.1,6.2,6.4,4.5,7.5,7.3,7,6.5,
                     7.8,4.8,6.6,5.3,7.3,5.7,7.6,7.6,6.3,5.3,5.5,5.3,7.9,7.8,7.1,7,7.8,7.9,7,7,7.3,7.9,7.8,8,7.5,8.2,7.3,
                     7.5,8,8,5.7,7.9,7.6,6.6,5.5,7.3,7.8,7.9,6,5.8,7.3,7,5.8,6.8,6.7,6.9,7.8,7.5,7.4,6.8,6.6,7.1,6.8,6.9,
                     6.5,7.1,7,7.6,7.4,5.9,7.6,7.3,5.9,7.1,6,6.5,7,6.3,6.8,7,5.5,5,7.3,4.8,6.4,5.4,6.3,6.6,5.9,6,6.5,6.8,
                     5.5,5,6.3,7.3,4.6,5.5,6.8,6,5.8,6.9,6,7,7.2,5.5,7,6.5,7.1,5.8,4.3,4.5,7.7,7.8,5.5,7.2,4.8,5.9,6.5,
                     5.7,5.3,7.7,7,7.1,6.5,6.6,6.5,6.6,6.8,6.8,6.5,7.3,5.5,6.5,6,6.1,7.3,7.1,5.5,7.3,5.8,6.3,7.4,6.8,5.8,
                     6.1,7,5,7,7.5,7.2,6.8,7,7.7,7.1,7.7,7.5,4.3,6.5,6.5,5.5,5.8,7,7,7.3,6,6,5.8,6.4,5.9,4.2,6.8,6.3,
                     7.3,6.5,7,5.7,7.6,3.9,5.3,7.3,6.3,5.6,7,6.4,4.7,6.8,7.5,6,6.5,6.5,7.2,7.2,7,7.8,5,3.5,5,7,7.7,6,
                     7.1,6.3,6.3,6.3,7,7.3,6.3,6.7,6.8,6,6.4,5.8,6.1,6.3,6.8,7,7.3,6,5.8,5.3,5.5,7.5,7.25,7.5,8,7.75,
                     8,7.9,5.9,6.8,6.9,7.1,5.5,6.8,NA,6.8,7.4,6.3,5.8,7.1,7.6,7.2,6.8,7.4,7.2,8,7.8,6.8,5.3,7.3,8.2,7,
                     7.7,7.5,6,7.3,7.5,7.5,8,7.8,7.5,6.5,7,7.2,8.2,6.8,7.2,6.7,7.5,6.8,7.8,7.2,8.1,7.7,6.8,5.9),
           Food = c(9,7.5,5,7,7,9,6.5,4,7.5,9,8.5,7,7,8,8,5,7.5,6,7,6,6.5,7.5,7.5,6.5,7,7.5,7.5,7,7.5,7.5,9,8,7.5,
                    5,8,7,7,6.5,NA,8.5,8,8,7.5,7,7,4,5,7.5,7,8.5,5,6.5,5,6,NA,NA,NA,6,8,6,NA,NA,NA,NA,NA,NA,NA,
                    NA,8.5,NA,NA,5.5,7.5,NA,NA,NA,NA,NA,NA,6.5,NA,NA,NA,NA,NA,NA,NA,NA,NA,5,6.5,NA,NA,NA,NA,NA,NA,7.5,
                    8.5,NA,7,NA,7,NA,NA,NA,7,NA,NA,NA,7,NA,8,8.5,NA,NA,7,8,NA,NA,NA,NA,7.5,7.5,NA,8.5,NA,8,7.5,
                    6.5,6.5,NA,8,8,NA,NA,8,7,6.5,NA,6.5,NA,7.5,NA,7.5,NA,NA,NA,7,NA,NA,7.5,7,8,7,6.5,8,7.5,6,8,
                    NA,NA,NA,7.5,7.5,7,6,NA,8,6,NA,NA,7,NA,7.5,NA,NA,NA,6,NA,NA,7,NA,NA,NA,7.5,NA,7.5,NA,7,NA,NA,
                    NA,7.5,NA,NA,NA,2,8.5,8.5,NA,7.5,4,7.5,NA,NA,NA,7,NA,7,6.5,NA,NA,7,NA,NA,7,NA,NA,6,NA,NA,8,7,
                    5,7.5,5.5,NA,NA,NA,NA,NA,6.5,6,NA,8,7,NA,NA,7.5,6.5,7.5,8,5,6,7.5,6.5,5,7.5,7,7.5,NA,NA,NA,NA,
                    6.5,5.5,7.5,6,NA,8,7,NA,8.5,4.5,5.5,NA,NA,6,6,6.5,NA,6,6.5,NA,7,7,NA,8,7,7.5,NA,NA,5.5,7.5,6.5,
                    7,7.5,7.5,6.5,6,6.5,8,6,6,6.5,NA,6.5,NA,6,NA,7.5,7.5,7,NA,7.5,NA,NA,7.5,NA,9,9,8,9,NA,6,NA,NA,
                    NA,NA,NA,NA,NA,8,7.5,6.5,8,8.5,8,NA,8.5,8,NA,8,6.5,2.5,NA,8.5,NA,8,7,NA,NA,8,7.5,NA,7.5,7.5,NA,
                    7.5,7.5,8,7,7.5,7,NA,7,8,7.5,NA,7.5,7,7),
           Drinks = c(7.5,NA,7,NA,NA,NA,7.5,NA,NA,NA,NA,NA,NA,5,7,NA,NA,NA,6,6,6.5,NA,NA,5.5,NA,NA,7.5,NA,NA,8,8.5,NA,
                      7,NA,NA,7,NA,NA,NA,7.5,NA,7.5,NA,7,NA,NA,NA,7,NA,7,NA,NA,6,NA,7,NA,7,6.5,7.5,7,8,6,8,NA,6,
                      6,6.5,3,8,6,6,6,7.5,7.5,4,8,6.5,5.5,5,9,7,7,8.5,6.5,9,6,6,5.5,7.5,7.5,6,2,NA,NA,NA,NA,NA,6.5,
                      7.5,NA,8,5,6.5,6.5,6,NA,NA,4.5,8,NA,NA,6,NA,NA,NA,7,NA,NA,7.5,7,NA,NA,7,7.5,8,NA,NA,7.5,7.5,NA,
                      6.5,7.5,NA,8.5,6,NA,NA,6.5,NA,7,6.5,7,NA,7,7,5,7,6.5,6.5,7.5,7,7.5,NA,NA,8.5,6,8,NA,NA,8,6,6.5,
                      7,NA,NA,7,NA,6,NA,NA,7,5,NA,7.5,NA,NA,NA,6.5,6.5,NA,NA,NA,5,NA,NA,NA,NA,7.5,6,7,NA,NA,7.5,6.5,
                      7.5,NA,NA,NA,NA,NA,NA,7.5,NA,NA,NA,NA,NA,7.5,NA,NA,6.5,6,7,6.5,NA,NA,NA,NA,NA,NA,NA,4,6,7,NA,
                      NA,NA,NA,8,NA,NA,7,NA,NA,NA,NA,NA,NA,7,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,7,NA,6.5,NA,NA,
                      7,NA,NA,NA,8,5.5,NA,NA,NA,7.5,7,6,NA,NA,5,NA,NA,NA,NA,NA,7.5,NA,NA,8,6,NA,NA,NA,8,NA,7.5,6,
                      6,NA,7,NA,NA,NA,NA,NA,6.5,NA,NA,NA,NA,8,NA,NA,NA,6,6.5,NA,8.5,7,NA,NA,8.5,8,6.5,6.5,6.5,6,NA,
                      7.5,NA,8,7.5,NA,NA,NA,7.5,NA,NA,8,NA,NA,NA,NA,NA,6,8,7,NA,NA,6,NA,NA,NA,NA,NA,NA,6,NA,NA,NA,
                      NA,NA,NA,8,NA,NA,NA,8.5,NA,NA,6.5),
           Dessert = c(NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
                       NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,8,NA,NA,6.5,NA,NA,7.5,NA,NA,NA,
                       NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,8.5,8,7.5,
                       7,8,NA,NA,7,NA,NA,NA,NA,NA,6,NA,NA,NA,NA,NA,NA,NA,7.5,7,NA,NA,NA,NA,NA,8.5,NA,NA,NA,NA,7.5,NA,
                       NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
                       NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
                       NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,7,NA,NA,NA,NA,NA,NA,NA,NA,
                       NA,NA,NA,NA,NA,NA,NA,6.5,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,6,NA,NA,
                       NA,NA,NA,NA,NA,NA,7.5,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
                       NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,8.5,NA,NA,
                       NA,NA,8,NA,NA,NA,NA,NA,NA,NA,NA,6.5,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,
                       NA,NA,8,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA),
           Service = c(9,7.5,8,NA,NA,NA,NA,NA,NA,8,7.5,7,NA,NA,8,NA,NA,7,NA,NA,NA,NA,7,NA,NA,NA,NA,NA,NA,7.5,8.5,6.5,
                       NA,NA,7,7.5,NA,6.5,NA,7,7.5,7.5,NA,NA,6,NA,NA,NA,NA,NA,NA,NA,NA,NA,7,NA,7.5,6,7.5,6.5,8,NA,8,
                       NA,NA,NA,6.5,6.5,8.5,6,7,5.5,8,6,5.5,8,6.5,NA,5,8,6.5,7,7,5.5,8.5,6.5,5.5,6,7.5,6.5,6,7,8,8,
                       7,7.5,7.5,5,7,5,7.5,NA,8,7.5,6,4,5,5,8,NA,7,7,NA,8,NA,NA,NA,8,8,8.5,6.5,9,7,7,8,NA,5.5,8.5,
                       8,6,6.5,7,NA,8,NA,5.5,7.5,6.5,6,7,7,7,NA,NA,7.5,8,6,7.5,7,6.5,7,7,7,8,7.5,NA,7.5,7,6,6.5,NA,5.5,
                       NA,NA,NA,7,6,5,7.5,7,7.5,5,5.5,6,5,NA,NA,NA,6,NA,6,8,5,6.5,NA,5.5,5.5,7.5,NA,7.5,7,NA,6.5,NA,
                       6.5,6,4,5,7.5,8,NA,7,NA,5,6.5,5,NA,7.5,NA,7.5,6.5,7,6,6,NA,NA,6.5,NA,5.5,7,NA,6.5,NA,7.5,5.5,
                       7,NA,NA,8.5,NA,NA,6,7,NA,NA,7,NA,7,7,NA,7,7,6.5,6,NA,6,NA,6,6.5,NA,6.5,NA,6,6.5,7,6,NA,6.5,
                       NA,7.5,7,7.5,NA,7,3,NA,7,NA,6,7.5,6.5,5,7,7.5,6,NA,6.5,6.5,5.5,NA,7,NA,NA,NA,7,NA,NA,5.5,5,6.5,
                       6.5,7.5,7,NA,NA,NA,NA,NA,6,6,7,NA,NA,NA,NA,6,NA,NA,NA,8.5,6.5,7.5,NA,9,7.5,5.5,6.5,6.5,7.5,5,
                       7,NA,6.5,8,7,7,7.5,8.5,6.5,6.5,8,6.5,NA,8,6.5,6.5,NA,NA,6.5,7.5,7,6,8,7,7.5,NA,NA,7,NA,6.5,NA,
                       8.5,7,7,6,7,7,7.5,7,8.5,7.5,7,6),
           Atmosphere = c(8,9,7.5,9,5,5,6.5,4,7.5,8,7.5,6,5,5.5,7,3,6,7.5,5,7.5,8,6,7.5,6,4,7.5,7.5,5,6,7.5,8,6.5,7.5,6,
                          6,7.5,5,5,NA,7,7.5,8.5,5,7,5,7.5,6.5,6.5,3,7.5,5,3,6,7,6.5,6.5,7.5,6,7.5,6.5,7.5,NA,7.5,4,NA,
                          4,7,7,8,5.5,7,5.5,8.5,7.5,3,7.5,6,7.5,4.5,8,7,7.5,8,7,8,7,7,4.5,7.5,7.5,7,4,NA,7,7,5,NA,3,
                          7,4,7,6,8,8,6,NA,5,6.5,7.5,7.5,7,8,7.5,7.5,NA,NA,6,7.5,8,9,7,8,7,7.5,8.5,NA,5,8,7.5,6,2,7.5,
                          8,8.5,5.5,5.5,7.5,7.5,5.5,6.5,7,7,8,8.5,7.5,7.5,7,8.5,NA,7.5,6,7,7.5,8.5,8,6,8,7,6.5,7,NA,7.5,
                          NA,5,7,6.5,5,4.5,7,4,4,5,5.5,7,5,NA,6,NA,4,NA,8,6.5,3.5,6,7.5,7,7,7,NA,7.5,7,NA,8,6,8,5.5,5,
                          4,7,8,5.5,8,5.5,6,6.5,7.5,6,8.5,7.5,7.5,7,7.5,6.5,7,NA,6.5,6,8,6,6.5,7,7,8,8,6.5,7,6,7,8,7,
                          5,5.5,7,5,NA,7.5,7.5,7.5,7,8,7.5,8.5,8,2,7,6,4.5,8,7,7,8,NA,5,5.5,6.5,4,3,7,6.5,7.5,6,7.5,
                          5,7.5,4,5,7.5,NA,4.5,7.5,6,4,8,9,NA,6,6,7.5,NA,7,8.5,4,3.5,4.5,6.5,8.5,5,7.5,6.5,6,NA,NA,7,6.5,
                          8.5,8,6,7,5.5,5.5,7,6,8,7.5,6.5,4.5,NA,5.5,NA,8,8,7.5,NA,8,8,5,7,8,8,5.5,7,NA,6.5,7.5,5.5,2.5,
                          7,8.5,7,8,6.5,7,8,7.5,7.5,4,8.5,8,7.5,7.5,8.5,6,6.5,7.5,7.5,8,8,8,7,NA,6,8,6.5,7,7,7.5,6.5,
                          8,7,8.5,8,6.5,4),
           Price = c(7,6.5,5,6.5,7,6.5,6,5,5.5,4.5,7,5,7,4,6,7,6,5,6,5.5,6,6,NA,6,7,4,4,7,8,6,7,7,5,5,7,7,6.5,5,NA,
                     7.5,7.5,8,5,5,6,5,5,5,5,7,5,4,4,6,7,5,7.5,6,7.5,6.5,8.5,NA,6.5,6,NA,6,7,6.5,7,7,6.5,7,5.5,6,5,6.5,
                     NA,NA,6,4,7,6.5,6,6,4,6,5.5,NA,2,4.5,6.5,5,6,6,6.5,NA,NA,2,3,5,7,6,8.5,8.5,7,6,5,5,8,8,7.5,NA,8,
                     8,NA,NA,9,8,7.5,7.5,8,7.5,8,8,7.5,NA,6.5,7.5,7.5,8,6,7,7.5,6.5,6.5,6.5,6,7.5,5,6.5,6.5,6.5,NA,7,
                     NA,NA,6.5,6,NA,6,6,6.5,6.5,6,6,5,6.5,7.5,5,6,NA,NA,NA,NA,6,7.5,5,4.5,6.5,2,7,6.5,7,6,6,6,7,
                     7,5,5,5,7.5,5,4,6,4,5,5,NA,6,7.5,5.5,6,6,6.5,6,4,7,NA,6.5,5.5,6,5,5,6.5,4.5,4.5,8,6.5,6.5,6,
                     6,6.5,6.5,6.5,7,NA,6.5,5,NA,5,7,NA,6,5,7.5,6,5.5,5,6.5,NA,6,7.5,4,7,7.5,7,6,NA,7.5,7.5,NA,NA,
                     NA,NA,6.5,NA,4,7,NA,NA,NA,6,5.5,5.5,7,4,6,NA,7,4,5,6.5,7.5,4,NA,NA,5.5,NA,NA,6.5,NA,6,7,NA,
                     NA,NA,NA,8,NA,NA,NA,NA,5,NA,NA,NA,7.5,NA,NA,NA,NA,7,NA,5.5,6,NA,5.5,NA,7,5,7,4.5,NA,5.5,5,4.5,
                     4.5,NA,4,7,8,7.5,5,8,6.5,7,6.5,6,6,5.5,NA,6,6,5,7,6,6,NA,6,6,NA,NA,NA,NA,8,NA,NA,NA,NA,NA,
                     NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,7,NA,NA,NA),
           HasMeal = c(T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,
                       T,T,T,T,T,F,F,F,F,T,F,T,F,F,F,F,F,F,F,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,F,F,F,F,F,T,T,F,
                       T,F,T,F,F,F,T,T,F,F,T,F,T,T,F,T,F,T,F,F,T,T,T,T,F,T,F,T,T,T,T,F,T,T,F,F,T,T,T,T,T,F,T,F,T,F,T,F,T,T,
                       F,T,T,T,T,T,T,T,T,T,T,T,F,T,T,T,T,T,T,T,F,T,T,F,T,F,T,F,T,F,F,T,T,F,T,T,T,T,T,T,T,T,T,T,T,F,F,T,T,T,
                       F,T,T,T,T,T,T,T,T,T,T,T,T,T,F,F,T,F,T,F,F,F,T,T,T,T,T,F,F,F,F,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,
                       T,T,F,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,F,T,T,T,T,T,T,F,T,F,T,T,T,T,T,T,T,T,T,T,T,T,F,T,F,T,T,T,
                       T,T,F,T,F,F,T,T,T,T,T,T,F,T,T,F,T,F,T,T,T,T,T,T,T,T,T,F,T,T,T,T,T,T,F,T,T,T,T,F,F,T,T,F,F,T,T,T,T,T,
                       T,T,T,T,T,T,T,F,T,T,T),
           HasAlcohol = c(T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,
                          T,T,T,T,F,F,T,F,T,F,T,F,F,F,F,F,T,F,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,T,F,F,F,F,F,T,T,
                          F,T,F,T,F,T,F,T,T,F,F,T,T,T,T,F,T,F,T,T,T,T,T,T,T,T,T,F,T,T,F,T,T,T,T,F,F,F,T,T,T,T,T,F,
                          T,T,T,T,T,T,T,T,T,F,F,T,T,T,F,T,T,T,T,T,F,F,T,F,T,T,T,T,T,T,T,F,F,F,T,T,F,F,F,T,F,F,F,F,T,T,T,T,F,T,
                          T,T,F,T,F,T,T,F,T,T,T,T,F,T,T,T,F,T,T,T,T,F,F,T,F,T,F,F,F,T,T,F,F,F,F,T,F,F,T,T,F,F,F,F,F,F,F,T,T,
                          F,T,T,F,F,F,F,F,T,T,T,F,T,T,F,F,F,F,T,T,F,F,F,F,T,T,T,T,F,T,F,F,F,T,T,T,F,T,T,T,F,F,F,T,T,T,T,T,F,T,
                          F,T,T,T,F,T,F,T,T,T,T,T,F,T,T,T,T,T,T,F,T,T,T,T,T,T,T,F,T,F,T,T,T,F,F,T,F,F,T,T,T,T,T,F,T,T,T,T,T,T,
                          T,T,T,T,T,T,F,F,F,T,T,T,T,T,T,T,T,T,T,T,T),
           HasWorkspace = c(F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,F,F,
                            F,F,F,F,F,F,F,F,F,F,F,F,T,T,F,T,T,T,T,T,T,T,T,F,T,T,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,
                            F,F,F,T,T,T,T,T,F,F,F,T,T,T,T,T,F,F,F,T,F,F,F,F,F,F,T,F,F,F,F,F,F,F,F,T,F,T,F,F,F,F,F,T,F,T,T,F,
                            F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,F,T,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,T,F,F,T,T,F,T,
                            F,F,F,F,F,F,F,T,F,T,F,F,F,F,F,F,F,F,T,F,F,F,F,F,F,F,F,T,F,F,F,F,F,F,F,F,F,T,T,F,T,T,F,F,F,F,
                            F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,T,F,F,F,F,T,F,F,T,F,F,F,F,F,F,F,F,F,F,F,
                            T,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,F,F,F,F,T,F,F,F,F,F,T,F,F,F,F,F,F,T,F,F,F,F,F,T,F,
                            T,F,F,F,F,F,F,F,F,F,T,F,F,F,F,F,F,T,F,T,F,T,T,T,F,T,T,T,F,F,F,T,T,F,F,F,F,F,F,F,F,F,F,F),
           HasRecreation = c(F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,
                             F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,F,F,F,F,F,F,F,F,F,F,F,
                             F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,T,F,F,F,F,F,
                             F,F,F,T,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,F,
                             F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,T,F,F,F,T,F,T,F,F,F,F,F,F,F,F,F,
                             T,F,T,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,F,F,T,
                             F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,F,F,F,F,F,F,F,F,
                             F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,T,F,F,F,F,F,F,F,T,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F),
           longitude = c(-75.709643,-75.70666,-75.709526,-75.71168,-75.713217,-75.708308,-75.726503,-75.720119,-75.713238,
                         -75.712347,-75.708314,-75.70954,-75.690376,-75.68753,-75.696329,-75.704346,
                         -75.683367,-75.695862,-75.697734,-75.695158,-75.697792,-75.70453,
                         -75.707277,-75.707825,-75.692349,-75.691583,-75.697197,-75.697011,
                         -75.690981,-75.706338,-75.702706,-75.730784,-75.73354,-75.751669,
                         -75.692693,-75.692138,-75.693339,-75.694406,-75.703913,-75.689114,
                         -75.710575,-75.707898,-75.695046,-75.684365,-75.710236,-75.712625,
                         -75.730606,-75.723598,-75.723506,-75.706643,-75.696643,-75.687756,
                         -75.686681,-75.6884,-75.706057,-75.7333,-75.722671,-75.710517,
                         -75.705323,-75.72374,-75.702406,-75.688067,-75.754016,-75.692919,
                         -75.727557,-75.718566,-75.695872,-75.704743,-75.698116,-75.700444,
                         -75.718492,-75.709049,-75.728447,-75.722597,-75.695894,-75.708766,
                         -75.698594,-75.703983,-75.70703,-75.692925,-75.689766,-75.688259,
                         -75.752519,-75.75187,-75.693716,-75.693248,-75.691138,-75.713539,
                         -75.708719,-75.709068,-75.732319,-75.709491,-75.721752,-75.692723,
                         -75.688738,-75.688065,-75.694996,-75.691814,-75.805361,-75.8006783,
                         -75.70646,-75.730791,-75.6978392,-75.6979142,-75.6980778,
                         -75.6797387,-75.6987864,-75.6996552,121.0428001,126.1607959,
                         126.1068209,121.0154736,121.0563402,121.0204942,121.021778,
                         121.0438129,120.980728,121.0297809,121.0528266,121.0517618,
                         121.0494609,121.0462206,121.0464089,121.0538188,121.0522191,
                         120.9813912,120.981794,126.1625184,126.1630651,126.1619227,
                         126.1633125,126.1623369,121.0361977,121.0367417,120.98446,
                         120.9974936,-75.6676889,-75.7120035,-75.834256,-76.48079,
                         -76.40356,-76.50757,106.70005,105.85402,105.85057,105.85053,
                         106.6973,105.8123,3.87837,3.87571,3.86891,3.88235,3.88075,
                         3.87388,3.87942,-75.92834,-79.37904,-79.38227,-79.38405,
                         -79.40232,-79.39361,-75.70147,-77.90593,-79.50212,-79.36540102,
                         -123.14627,-75.74973,-79.38472,-79.34346,-79.4077,121.04743,
                         121.06741,-75.55208,-79.40014,-75.69012,-123.13913,-119.59302,
                         -119.59166,-71.20913,-119.59222,-123.13834,-81.25254,-123.23549,
                         -119.55111,-81.25147,-73.97976,-75.70528,-79.47973,-75.68674568,
                         -75.72928242,-79.34695174,-123.1388429,-123.1364282,-73.56355231,
                         -75.91761482,-66.12972886,106.7025223,-75.51637345,105.8460596,
                         -75.69921902,121.0053703,3.878916041,-79.3489056,-75.7360454,
                         -75.91004352,-123.1076447,-79.3578875,-75.71145456,-76.48150995,
                         -73.60465653,-79.19564463,-75.71890571,-81.24577171,-81.24130072,
                         -119.5714178,-75.68455563,-79.39876548,-64.48627087,-73.55396038,
                         -64.48265868,-64.48347407,-123.1340484,-79.39008787,-79.18707005,
                         -95.33337166,-79.38162521,-79.35709406,-79.28728945,-79.4251735,
                         -75.68374232,-119.5525887,-81.24446782,-81.23965821,-79.32856672,
                         -79.3787106,-79.32468208,-79.42481927,-74.94308877,-75.70404694,
                         -79.38866955,-76.49307204,-79.41146888,-79.27021721,-79.36921619,
                         -75.54653241,-79.53136273,-75.67805812,-79.39089184,-79.23489167,
                         -79.24084416,-79.3811299,-79.32557591,-75.71464661,-79.34236991,
                         -75.68375165,-70.90782763,-79.37800408,-75.6813274,-79.38626197,
                         -119.8257759,-79.37483698,-75.70989001,-79.14857934,-79.40231852,
                         -74.16497821,-79.24330863,-75.68863029,-74.05486475,-66.13328599,
                         -79.38054947,-81.2501587,-79.28852602,-79.3714196,-73.97227004,
                         -123.2463866,-81.25138849,-81.24845227,-123.136609,-79.18692133,
                         -79.29506854,-79.37066351,-75.54524305,-83.07561141,-79.4246225,
                         -75.73028575,-123.1002595,-79.28281687,121.0491638,121.0530058,
                         -81.25116147,-79.21841767,-95.33443595,-79.252769,-77.58695236,
                         -79.37918833,-79.37755751,-119.4646093,-79.38014903,-75.51652363,
                         -83.04099925,-79.38505108,-75.55534943,-79.41052342,-79.40929694,
                         -79.23416677,-75.69486575,-75.65636583,-79.39829241,-75.70938307,
                         -75.69447917,-75.69963702,-75.7022039,-75.64180825,-75.81254664,
                         -75.77844294,-75.68946882,-75.69096997,-75.71221008,-75.68875637,
                         -75.68473334,-75.73226927,-75.71013554,-75.68661587,-75.68435774,
                         -75.68693302,-75.78147161,-75.70637377,-75.71195265,-75.7388431,
                         -75.7321774,-75.71080883,-3.965372445,-3.9866484,-3.949781307,
                         -3.940069143,-3.943154144,-3.936794903,-3.936569503,-4.014125324,
                         -3.196002145,-3.180526414,-3.177926213,-2.980630381,-3.017759655,
                         -3.020121885,-1.259254374,-1.255731616,-1.250482902,-1.256456982,
                         -1.257041173,-1.257092864,-1.271977279,-1.268051221,-3.943195504,
                         -4.258415545,-4.254761874,-4.258602151,-4.283762769,-4.224217187,
                         -3.188469489,-3.194653761,-3.188841526,-3.186790445),
           latitude = c(45.400349,
                        45.410827,45.410193,45.409029,45.408803,45.398991,45.402278,
                        45.406431,45.406465,45.40565,45.398998,45.40753,45.428241,
                        45.402666,45.416465,45.407749,45.393966,45.41456,45.414971,
                        45.413776,45.416768,45.411861,45.410682,45.410774,45.430554,
                        45.428999,45.419158,45.416408,45.40793,45.41109,45.412894,
                        45.400077,45.399229,45.393234,45.410297,45.410024,45.41117,
                        45.413293,45.412095,45.403845,45.409167,45.407138,45.413637,
                        45.399819,45.409868,45.408986,45.400531,45.404695,45.405282,
                        45.412714,45.411955,45.401388,45.400672,45.415912,45.411466,
                        45.408581,45.405643,45.401802,45.406967,45.405049,45.413062,
                        45.402784,45.391902,45.410122,45.402804,45.407964,45.418915,
                        45.411779,45.417611,45.41383,45.407762,45.399423,45.40609,
                        45.405453,45.414986,45.408567,45.417765,45.41208,45.410708,
                        45.429218,45.416905,45.415603,45.392845,45.393144,45.412535,
                        45.410782,45.40836,45.407584,45.399082,45.400254,45.399771,
                        45.400108,45.401252,45.410891,45.404064,45.414902,45.413978,
                        45.4193318,45.355295,45.356656,45.411015,45.402321,45.3833405,
                        45.3833887,45.3835109,45.3903368,45.4150637,45.4216606,14.5747953,
                        9.807742383,9.7595281,14.5597808,14.5835766,14.5521393,14.551819,
                        14.5741325,14.535088,14.6564028,14.5575911,14.5563853,14.5518292,
                        14.5519545,14.5518875,14.5566385,14.5565898,14.5342065,14.530876,
                        9.787972,9.7895876,9.7863511,9.7891679,9.787052,14.5649154,
                        14.5633353,14.5749011,14.1254191,45.4338815,45.404281,45.3224749,
                        42.48029,42.47104,42.43867,10.7695,21.03097,21.00941,21.03555,
                        10.78236,21.03187,43.6046,43.61289,43.62833,43.6051,43.60721,
                        43.61166,43.61309,45.63358,43.66038,43.65871,43.66145,43.65437,
                        43.64639,45.42091,44.02196,43.6233,43.7137048,49.26781,
                        45.37788,43.63787,43.67896,43.74698,14.54852,14.58449,10.42364,
                        43.64805,45.42741,49.25918,49.49958,49.49802,46.81055,49.49915,
                        49.26343,42.98009,49.25429,49.18061,42.98311,40.76354,45.40588,
                        43.65016,45.40071697,45.38789745,43.65989199,49.25945998,
                        49.27299698,45.50479461,45.34789247,48.10556201,10.77373484,
                        10.44806211,21.03308781,45.41957368,14.50549179,43.61315246,
                        43.75594962,45.35902686,45.3098987,49.3219788,43.6506494,
                        45.40919055,44.23127943,45.53383243,43.79047804,45.40921293,
                        42.98496844,42.98588422,49.34096566,45.42951251,43.64507832,
                        48.82864753,45.50560063,48.83026322,48.82998777,49.27042127,
                        43.64645295,43.78500712,29.98622917,43.65774044,43.81282285,
                        43.67283941,43.66220237,45.39463163,49.18178851,42.98538427,
                        42.98073268,43.67180317,43.6718333,43.67161081,43.66205064,
                        45.65031675,45.41210022,43.64788605,44.23290548,43.76265314,
                        43.78781644,43.66785817,10.42135798,43.77414643,45.40911273,
                        43.67142696,43.77633693,43.7749295,43.6613039,43.82101577,
                        45.40890622,43.69336848,45.39478337,46.91191883,43.6480336,
                        45.39168801,43.76860709,49.20499977,43.70397471,45.40182716,
                        43.79792153,43.6546739,45.89021459,43.81117377,45.42707137,
                        46.03114861,48.10856668,43.65665655,42.98288396,43.73136756,
                        43.65296245,40.75225387,49.26601016,42.98339801,42.98419712,
                        49.27064954,43.7718632,43.67122718,43.6634913,10.42048497,
                        42.30220782,43.81570738,45.40023907,49.28425758,43.6738026,
                        14.55161687,14.55762078,42.98147457,43.73821933,29.98577287,
                        43.77157471,44.49727387,43.65575452,43.6563237,49.03311859,
                        43.6641503,10.44550671,42.31649688,43.6596404,10.40199584,
                        43.66518167,43.66569989,43.77630333,45.42902752,45.43819284,
                        43.70748153,45.4001502,45.42531273,45.41680032,45.41902464,
                        45.44230608,45.50103669,45.47701239,45.4057011,45.40781517,
                        45.40911716,45.40426155,45.39902274,45.39942847,45.40991853,
                        45.40017854,45.39981243,45.40085467,45.26870784,45.33183768,
                        45.40437689,45.39837736,45.39979629,45.4023004,51.61145485,
                        51.57147103,51.61870639,51.61963653,51.62019419,51.61669449,
                        51.61404611,51.56772696,51.48138853,51.48052802,51.4775856,
                        51.88043247,51.82170249,51.82172908,51.75741463,51.75157777,
                        51.75249965,51.75244271,51.75298641,51.75053482,51.75242836,
                        51.75253307,51.61584943,55.86226606,55.86136643,55.86138662,
                        55.86444286,57.47702927,55.95022448,55.94861535,55.94982706,
                        55.94812404))
  }

# Define UI for app that draws a histogram ----
ui <- shinyUI(fluidPage(
  
  # App title ----
  titlePanel("Find a review near you!"),
  
  # Sidebar layout with input and output definitions ----
  sidebarLayout(
    position = "right",
    # Sidebar panel for inputs ----
    sidebarPanel(
      sliderInput(inputId = "minScore",
                  label = "Minimum Score:",
                  step = 0.5,
                  min = 0,
                  max = 10,
                  value = 0),
      numericInput("radius", "Search radius (km)", min = 0, max = NA, value = NA),
      checkboxGroupInput("ologs", label = "What would you like to do?", inline = T,
                         choices = c("Eat", "Drink", "Caffeinate", "Recreate", "Study")),
      checkboxGroupInput("criteria", label = "What criteria are important?", inline = T,
                         choices = c("Food", "Drinks", "Atmosphere", "Service", "Price")),
      checkboxGroupInput("continents", "Select continent of origin:",
                         choices = levels(factor(reviews$Continent))
                         # selected = levels(factor(reviews$Continent))
                         ),
      plotOutput('plot',   height = "300px")
    ),
    # Main panel for displaying outputs ----
    mainPanel(
      tabsetPanel(
        type = "tabs",
        tabPanel("Map", leafletOutput("map", width = "100%", height = "850px")),
        tabPanel("Data", DTOutput("tbl")),
        tabPanel("About", htmlOutput("abt"))),
    )
  )
))

# Define server logic required to draw a histogram ----
server <- function(input, output, session) {
  
  filt <- reactive({
    {filt <- reviews %>% 
      filter(Score >= input$minScore,
             ((Continent %in% input$continents) | length(input$continents) == 0),
             
             ((HasMeal & "Eat" %in% input$ologs) | !("Eat" %in% input$ologs)),
             ((HasAlcohol & "Drink" %in% input$ologs) | !("Drink" %in% input$ologs)),
             ((Style == "Cafe" & "Caffeinate" %in% input$ologs) | !("Caffeinate" %in% input$ologs)),
             ((HasRecreation & "Recreate" %in% input$ologs) | !("Recreate" %in% input$ologs)),
             ((HasWorkspace & "Study" %in% input$ologs) | !("Study" %in% input$ologs)),
             
             ((!is.na(Food) & "Food" %in% input$criteria) | !("Food" %in% input$criteria)),
             ((!is.na(Drinks) & "Drinks" %in% input$criteria) | !("Drinks" %in% input$criteria)),
             ((!is.na(Atmosphere) & "Atmosphere" %in% input$criteria) | !("Atmosphere" %in% input$criteria)),
             ((!is.na(Service) & "Service" %in% input$criteria) | !("Service" %in% input$criteria)),
             ((!is.na(Price) & "Price" %in% input$criteria) | !("Price" %in% input$criteria))
      )
    if (!any(is.na(input$radius) | input$radius == 0 | is.null(input$map_click$lng))) {
      dists <- distance(x = as.matrix(select(filt, longitude, latitude)),
                        y = matrix(rep(c(input$map_click$lng, input$map_click$lat), nrow(filt)), byrow = T, ncol = 2),
                        lonlat = T, pairwise = T)
      filt <- filt[which(dists <= input$radius*1000), ]}
    }
    return(filt)
  })
  
  zoom <- reactive({
    ifelse(is.null(input$map_zoom), 3, input$map_zoom) #12
  })
  center <- reactive({
    if(is.null(input$map_center)){
      return(c(40, -45)) #45.4, -75.715
    }else{
      return(input$map_center)
    }
  })
  
  output$plot <- renderPlot({
    hist_dat <- filt() %>% 
      pull(Score) %>% 
      as.numeric(.)
    
    try(expr = {
      hist(hist_dat, xlab = "Score", main = "Distribution of scores", xlim = c(0,10))
      abline(v = mean(hist_dat), col = 'red', lwd = 1)
      abline(v = median(hist_dat), col = 'red', lty = 2, lwd = 1)
      legend("topleft", lty = c(1,2), col = 'red', bty = 'n',
             legend= c(paste0("Mean = ",sprintf("%.1f", round(mean(hist_dat), 1))),
                       paste0("Median = ",sprintf("%.1f", round(median(hist_dat), 1)))))
      legend("topright", lwd = 0, legend = paste0("n = ",length(hist_dat)),
             bty = 'n')
    }, silent = T)
  })
  
  output$map <- renderLeaflet({
    if (is.empty(vect(filt(), geom=c("longitude", "latitude")))) {
      showModal(modalDialog(title = "No establishments matching these criteria were found.\nTry again!", easyClose = T))
      leaflet(leafletOptions(preferCanvas = T, worldCopyJump = T)) %>%
        setView(zoom = zoom(), lat = center()[1], lng = center()[2]) %>% 
        addProviderTiles(layerId = "base", "CartoDB.Positron", options = providerTileOptions(noWrap = TRUE))
    } else if (any(is.na(input$radius) | input$radius == 0 | is.null(input$map_click$lng))) {
      leaflet(data = filt(), leafletOptions(preferCanvas = T, worldCopyJump = T)) %>%
        setView(zoom = zoom(), lat = center()[1], lng = center()[2]) %>%
        addTiles() %>%
        addMarkers(lng = ~longitude, lat = ~latitude,
                   popup = ~paste0(Name, "<br>", Style, "<br>", sprintf("%.1f", round(Score, 2)), "/10")) %>% 
        addProviderTiles(layerId = "base", "CartoDB.Positron", options = providerTileOptions(noWrap = TRUE))
    } else {
      leaflet(data = filt(), leafletOptions(preferCanvas = T, worldCopyJump = T)) %>%
        setView(zoom = zoom(), lat = center()[1], lng = center()[2]) %>%
        addTiles() %>%
        addMarkers(lng = ~longitude, lat = ~latitude,
                   popup = ~paste0(Name, "<br>", Style, "<br>", sprintf("%.1f", round(Score, 2)), "/10")) %>%
        addProviderTiles(layerId = "base", "CartoDB.Positron", options = providerTileOptions(noWrap = TRUE)) %>%
        addCircles(lat = input$map_click$lat, lng = input$map_click$lng, color = "#f00", opacity = 0.3,
                   radius = input$radius*1000) %>%
        addCircleMarkers(lat = input$map_click$lat, lng = input$map_click$lng, color = "#000", opacity = 0.3,
                         popup = paste("Click coordinates:",
                                       round(input$map_click$lat,3), round(input$map_click$lng,3)))
    }
  })
  
  output$tbl <- renderDT({
    datatable(data = filt() %>% 
                select(Name, Style, Continent, Score),
              options = list(scrollY = 500,
                             scrollX = 600,
                             deferRender = T,
                             scroller = T,
                             fixedColumns = F))
  })
  
  output$abt <- renderUI({
    par1 <- "The database schema underlying these reviews was inspired by ontology logs, or ologs. Ologs are a category theoretic approach to knowledge representation that is conducive to organizing databases in a rigorous but extensible way. More importantly, this structure allows users to decide for themselves if they want to study in a nightclub, drink coffee at a pub, or play billiards while eating a 5-star meal. While I don't personally recommend these particular combinations of activities, it is not my desire to limit users to the choices that I feel are appropriate. This framework allows for exactly that kind of flexibility."
    # par2 <- "Briefly, each establishment is an instance in the dataset with several attributes. For simplicity, none of these are compound attributes. It is up to the user to recombine information I have gathered how they see fit."
    par3 <- "Avail yourself of the geospatial functionality of this app! If you are up for taking a walk, find your location on the map, specify a search radius (in km), and click. If there are reviews in your area, they will pop up. Keep in mind that the score shown here is the mean across individually-scored attributes. Selecting a priority attribute ensures that the esbalishments shown were scored on that attribute. The minimum score still reflects the average across scored attributes."
    par4 <- "Please be patient with this serverless app as it is slow and finicky. For best results, use the +/- toggles to zoom. Happy critiquing!"
    new_par <- ""
    
    HTML(paste(par1, new_par, par3, new_par, par4, sep = '<br/>'))
  })
  
}

# Create Shiny app ----
shinyApp(ui = ui, server = server)

```
